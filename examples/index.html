<!doctype html>
<html>
<head>
  <script src='../test/vendor/moment.js'></script>
  <script src='../test/vendor/underscore.js'></script>
  <script src='../test/vendor/jquery.js'></script>
  <script src='../test/vendor/backbone.js'></script>
  <script src='../kinetic.js'></script>
  <script src='../attributes/template.js'></script>
  <script src='../attributes/content.js'></script>
  <script src='../attributes/list.js'></script>
</head>
<body>

  <div data-template='{"name": "content", "layout": "layout"}'>
  </div>

  <script id='layout' type='text/html'>
    <h1 data-html='title'></h1>
    <div><%= content %></div>
  </script>

  <script id='content' type='text/html'>
    <p data-html='body'></p>
    <em data-date='{"attr": "created_at", "format": "MM-DD-YYYY"}'></em>
    -
    <span data-template='{"name": "author", "model": "@model.author"}'></span>
    <br>
    <span data-list='{"collection": "@model.tags", "template": {"name": "tag"}}'>
      <span></span>
    </span>
  </script>

  <script id='author' type='text/html'>
    <span data-html='title'></span>
    <em data-html='name'></em>
  </script>

  <script id='tag' type='text/html'>
    <span data-html='name'></span>
  </script>

  <script>
    jQuery(function($) {

      templates = Kinetic.templates;

      $('script[type="text/html"]').each(function() {
        templates[this.id] = _.template($(this).html());
      });

      post = new Backbone.Model({
        title: 'Stuff and Nonsense',
        body: 'Lorem Ipsum dolor sit amet...',
        created_at: new Date()
      });

      post.author = new Backbone.Model({
        title: 'Mr.',
        name: 'Brad Dunbar'
      });

      post.tags = new Backbone.Collection([
        {name: 'foo'},
        {name: 'bar'},
        {name: 'baz'}
      ]);

      view = new Kinetic.View({
        el: $('body'),
        model: post
      }).render();

    });
  </script>
</body>
</html>
